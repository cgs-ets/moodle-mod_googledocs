{"version":3,"sources":["../src/modal_grade.js"],"names":["define","$","Ajax","ModalFactory","Templates","ModalEvents","Log","init","studentid","instanceid","on","docname","attr","url","find","src","debug","create","title","body","footer","large","done","modal","gradeInput","val","grade","parseFloat","length","remove","isNaN","append","call","methodname","args","googledocid","userid","response","button","prop","fail","reason","error","hide","show"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Provides the mod_googledocs/modal_grade\n *\n * @package   mod_googledocs\n * @category  output\n * @copyright 2020 Veronica Bermegui\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module mod_googledocs/submit_controls\n */\n\ndefine(['jquery',  'core/ajax', 'core/modal_factory', 'core/templates', 'core/modal_events',  'core/log'],\n        function ($, Ajax, ModalFactory, Templates, ModalEvents, Log) {\n\n            var init = function (studentid, instanceid) {\n\n                $('button#submitbtn_' + studentid).on('click', function (e) {\n\n                    var docname = $('table.overviewTable').attr('data-file-name');   \n                    var url = $('tbody').find(\"tr[data-student-id='\"+studentid+\"']\").find('a')[1];\n                    var src = $(url).attr('href');\n                    Log.debug(src);\n                    ModalFactory.create({\n                        title: docname,\n                        body: '<iframe height=\"600\" width=\"750\" \\n\\\n                                src=\"'+src+ '\"> \\n\\\n                                Your browser does not diplay iFrames\\n\\\n                                </iframe>',\n                        footer: \"<div class='grade' style='margin-right:40%'><label for='fgrade'>Grade</label>\\n\\\n                                 <input type='text' id='fgrade_\"+studentid+\"' name='fgrade' >\\n\\\n                                 </div><button type='button' class='btn btn-primary' data-action='save'>Save</button>\\n\\\n                                <button type='button' class='btn btn-primary' data-action='next'>Next</button>\\n\\\n                                <button type='button' class='btn btn-secondary' data-action='cancel'>Cancel</button>\",\n                        large: true\n                    }).done(function (modal) {\n\n                    $(modal.footer[0]).find(\"button[data-action='save']\").on('click', function(){\n\n                        var gradeInput =  $('div.grade').find('input#fgrade_'+studentid).val();\n                        var grade = parseFloat(gradeInput);\n\n                        if ($('div.grade').find('p.grademessage').length > 0) {\n                            $('div.grade').find('p.grademessage').remove();\n                        }\n\n\n                            if(isNaN(grade)) {\n                                $( \".grade\" ).append( \"<p class='alert-danger alert grademessage'>Please provide a valid grade</p>\" );\n\n                            } else {\n                                Ajax.call([{\n                                  methodname: 'mod_googledocs_grade_student_file',\n                                      args: {\n                                              googledocid: instanceid,\n                                              userid: studentid,\n                                              grade: grade,\n\n                                              },\n                                      done: function (response) {\n                                              var button = $('div.modal-footer').find(\"button[data-action='save']\");\n                                              $(button).prop('disabled',true);\n                                              $('div.grade').find('input#fgrade_118').val(\"\"); // Erase vale from input.\n                                              $( \".grade\" ).append( \"<p class='alert-success alert grademessage'>Grade saved</p>\" );\n                                              Log.debug(response);\n                                          },\n                                      fail: function (reason) {\n                                              Log.error(reason);\n                                          }\n                              }]);\n\n                            }\n\n                        });\n\n                        $(modal.footer[0]).find(\"button[data-action='next']\").on('click', function(e){\n                            Log.debug(\"next CLICKED\");\n                        });\n\n                        $(modal.footer[0]).find(\"button[data-action='cancel']\").on('click', function(e){   \n                          modal.hide();\n\n                        });\n\n\n                        modal.show();\n                    });\n\n\n                });\n            };\n\n            return {\n                init: function (studentid, instanceid) {\n                    init(studentid, instanceid);\n                }\n            };\n        });"],"file":"modal_grade.min.js"}