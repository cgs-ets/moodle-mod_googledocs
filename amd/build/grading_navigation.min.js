define ("mod_googledocs/grading_navigation",["jquery","core/notification","core/ajax","core/str","mod_googledocs/save_grading"],function(a,b,c,d,e){var f=function(b){this._regionSelector=b;this._region=a(b);this._users=[];this._firstLoadUsers=!0;console.log("GradingNavigation....");this._loadAllUsers();this._region.find("[data-action=\"previous-user\"]").on("click",this._handlePreviousUser.bind(this));this._region.find("[data-action=\"next-user\"]").on("click",this._handleNextUser.bind(this));this._region.find("[data-action=\"change-user\"]").on("change",this._refreshView.bind(this))};f.prototype._isLoading=!1;f.prototype._regionSelector=null;f.prototype._filters=null;f.prototype._users=null;f.prototype._region=null;f.prototype._lastFilters="";f.prototype._loadAllUsers=function(){var a=this._region.find("[data-action=change-user]"),d=a.attr("data-googledocid"),e=a.attr("data-groupid");c.call([{methodname:"mod_googledocs_get_participants",args:{googledocid:d,groupid:e},done:this._setUsers.bind(this),fail:b.exception}]);return!0};f.prototype._setUsers=function(a){this._users=JSON.parse(a.users)};f.prototype._handlePreviousUser=function(b){b.preventDefault();this._handlePreviousUser_helper(b);var c=a("select.custom-select option").filter(":selected").val();c=parseInt(c,10);if(0<c){this._refreshView(b,c,!0)}};f.prototype._handlePreviousUser_helper=function(){var b=a(".custom-select option:selected").val();a(".custom-select option:selected").prev().attr("selected","selected");a("select.custom-select option[value='".concat(b,"']")).removeAttr("selected")};f.prototype._handleNextUser=function(b){b.preventDefault();var c=a(".custom-select option:selected").val(),d=a("select.custom-select option:last-child").val();if(c!=d){this._handleNextUser_helper(c);var e=a("select.custom-select option").filter(":selected").val();this._refreshView(b,e,!0)}};f.prototype._handleNextUser_helper=function(b){a("select.custom-select option:selected").next().attr("selected","selected");a("select.custom-select option[value='".concat(b,"']")).removeAttr("selected")};f.prototype.update_url=function(a){var b=new URL(window.location);b.searchParams.get("userid");b.searchParams.set("userid",a);window.history.replaceState({},"",b)};f.prototype._refreshView=function(b,c,d){c=d?c:b.target.value;c=parseInt(c,10);if(0<c){a(document).trigger("user-changed",c);f.prototype.update_url(c);f.prototype.get_user_by_id(c)}};f.prototype.get_user_by_id=function(b){var d=a("[data-region=\"user-info\"]").data("googledocid")+"";c.call([{methodname:"mod_googledocs_get_next_participant_details",args:{userid:b,googledocid:d},done:function done(b){var c=a("[data-region=\"grade\"]");c.fadeOut(300,function(){c.replaceWith(b.html);c.show();a("#gradeform").on("submit",e.init())})},fail:function fail(a){console.log("mod_googledocs_get_participant_by_id. Unable to get elements");console.log(a)}}])};f.prototype._handleChangeUser=function(){var c=this._region.find("[data-action=change-user]"),e=parseInt(c.val(),10);if(this._isLoading){return}a("#gradeform :input").change(function(){a("#gradeform").data("changed",!0)});if(a("#gradeform").data("changed")){d.get_strings([{key:"unsavedchanges",component:"mod_googledocs"},{key:"unsavedchangesquestion",component:"mod_googledocs"},{key:"saveandcontinue",component:"mod_googledocs"},{key:"cancel",component:"core"}]).done(function(c){b.confirm(c[0],c[1],c[2],c[3],function(){a(document).trigger("save-changes",e)})})}else{if(!isNaN(e)&&0<e){c.attr("data-selected",e);a(document).trigger("user-changed",e)}}};return f});
//# sourceMappingURL=grading_navigation.min.js.map
