define ("mod_googledocs/controls",["jquery","core/log","core/ajax"],function(a,b,c){'use strict';function d(a,b,c,d){var e=this;e.parentfile_id=a;e.create=b;e.group_sharing=c;e.instance_id=d}d.prototype.main=function(){var a=this;if(!a.create&&!a.group_sharing){a.callStudentFileService(a.parentfile_id)}else if(!a.create&&a.group_sharing){a.callGroupFileService()}else{a.initTags()}};d.prototype.initTags=function(){var a=this;if(a.group_sharing){a.initTagsByGroup()}else{a.initTagsByStudent()}};d.prototype.initTagsByStudent=function(){var b=this;a("tbody").children().each(function(c){if("#"!=a("#link_file_"+c).attr("href")){b.tagDisplay(c,!0)}else{b.tagDisplay(c,!1)}})};d.prototype.initTagsByGroup=function(){var b=this;a("tbody#group-members").children().each(function(c){if("#"!=a("#link_file_"+c).attr("href")){b.tagDisplay(c,!0)}else{b.tagDisplay(c,!1)}})};d.prototype.tagDisplay=function(b,c){if(!0===c){a("#file_"+b).html("Created");a("#file_"+b).addClass("tag_doc success")}else{a("#file_"+b).html("Failed");a("#file_"+b).addClass("tag_doc failed")}};d.prototype.callStudentFileService=function(b){var c=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!1,d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,f=this;a("tbody").children().each(function(c){var d=a(this).attr("data-student-id"),e=a(this).attr("data-student-email"),g=a(this).attr("student-name");f.create_student_file(c,d,e,g,b)})};d.prototype.callStudentFileServiceForByGroup=function(b,c){var d=this;a("tbody#group-members").children().each(function(f){var e=a(this).attr("data-student-id"),g=a(this).attr("data-student-email"),h=a(this).attr("student-name"),i=a(this).attr("student-group-id");if(i==c){d.create_student_file(f,e,g,h,b,!0,i)}})};d.prototype.create_student_file=function(d,e,f,g,h){var i=5<arguments.length&&arguments[5]!==void 0?arguments[5]:!1,j=6<arguments.length&&arguments[6]!==void 0?arguments[6]:0,k=this;a("#file_"+d).addClass("progress_bar processing");c.call([{methodname:"mod_googledocs_create_students_file",args:{by_group:i,group_id:j,instance_id:k.instance_id,parentfile_id:h,student_email:f,student_id:e,student_name:g},done:function done(c){b.debug(c.url);console.log("rownumber: "+d);var e=a("#link_file_"+d);a(e).attr("href",c.url);a("#file_"+d).removeClass("progress_bar processing");k.tagDisplay(d,!0)},fail:function fail(c){b.error(c);a("#file_"+d).removeClass("progress_bar  processing");k.tagDisplay(d,!1)}}])};d.prototype.callGroupFileService=function(){a("tbody#group-members").children().each(function(b){a("#file_"+b).addClass("progress_bar processing")});var b=a("table.overviewTable").attr("data-owner-email"),c=this;a("tbody").find("[ data-group-name]").each(function(){var d=a(this).attr("data-group-name"),e=a(this).attr("data-group-id");c.create_group_file(b,d,e)})};d.prototype.create_group_file=function(d,e,f){var g=this;c.call([{methodname:"mod_googledocs_create_group_file",args:{group_name:e,group_id:f,owner_email:d,parentfile_id:g.parentfile_id},done:function done(a){console.log(a);g.callStudentFileServiceForByGroup(a.googledocid,f)},fail:function fail(a){b.error(a)}}]);a("table.overviewTable").removeAttr("data-googledoc-id")};return{init:function(c,e){b.debug("mod_googledocs/control: initializing controls of the mod_googledocs");var f=a("table.overviewTable").attr("data-googledoc-id"),g=a("table.overviewTable").attr("data-instance-id"),h=new d(f,c,e,g);h.main()}}});
//# sourceMappingURL=controls.min.js.map
