define ("mod_googledocs/save_quick_grading",["jquery","core/ajax","core/log","core/notification"],function(a,b,c,d){'use strict';function e(){c.debug("constructor")}e.prototype.main=function(){var a=this;a.saveQuickGrading();a.refreshDateModified;a.onGradeChangeHandler();a.onCommentChangeHandler()};e.prototype.saveQuickGrading=function(){var e=this;a("button.submit-quickgrade").on("click",function(){var f=[],g=a("table.gradetb").attr("data-googledocid"),h=a("table.gradetb").attr("data-maxgrade"),i=a("table.gradetb").attr("data-maxgrade");a("tbody").children().each(function(b){var c=a(this).attr("data-user-id"),d=a(this).find("#quickgrade_"+c).val(),e=a(this).find("#quickgrade_comments_"+c).val();if(0==d.length&&0==e.length){return}var d={userid:c,grade:d,comment:e,googledocid:g,rownumber:b,maxgrade:h,courseid:i};f.push(d)});b.call([{methodname:"mod_googledocs_save_quick_grading",args:{grades:JSON.stringify(f)},done:function done(a){c.debug(JSON.parse(a.modifiedtimes));e.refreshDateModified(JSON.parse(a.modifiedtimes));d.addNotification({message:"The grade changes were saved",type:"success"})},fail:function fail(a){d.addNotification({message:"The grade changes were saved",type:"info"});c.error(a)}}])})};e.prototype.refreshDateModified=function(b){b.forEach(function(b){var c=a("tr").eq(b.rownumber+1).find("input.quickgrade").val();a("tr").eq(b.rownumber+1).find("input.quickgrade").val(function(a,d){return d.replace(c,b.grade)});a("tr").eq(b.rownumber+1).find("input.quickgrade").parent().removeClass("quickgrademodified");a("tr").eq(b.rownumber+1).find("textarea.quickgrade").parent().removeClass("quickgrademodified");a("tr").eq(b.rownumber+1).find("td.timemod").html(b.timemodified);a("tr").eq(b.rownumber+1).find("td.timemod").html(b.timemodified);a("tr").eq(b.rownumber+1).find("td.finalgrade").html(b.finalgrade);a("tr").eq(b.rownumber+1).find("div.submissionstatussubmitted ").html("Graded");a("tr").eq(b.rownumber+1).find("div.submissionstatus ").html("Graded").addClass("alert-success")})};e.prototype.onGradeChangeHandler=function(){a("input.quickgrade").on("change",function(b){var c=a(b.target)[0];a(c).parent().addClass("quickgrademodified")})};e.prototype.onCommentChangeHandler=function(){a("textarea.quickgrade").on("change",function(b){var c=a(b.target)[0];a(c).parent().addClass("quickgrademodified")})};return{init:function(){c.debug("mod_googledocs/SaveQuickGrading: initializing SaveQuickGrading of the mod_googledocs");var a=new e;a.main()}}});
//# sourceMappingURL=save_quick_grading.min.js.map
