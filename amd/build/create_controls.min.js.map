{"version":3,"sources":["../src/create_controls.js"],"names":["define","$","Log","Ajax","DeleteControl","GoogledocsControl","parentfile_id","create","instance_id","files_to_erase","countCalls","dist_type","group_folder_ids","self","prototype","main","initTags","callStudentFileService","callGroupFileService","callGroupingFileService","create_group_folder","document","ajaxStop","children","each","tag","find","removeClass","html","addClass","length","delete_file_from_grouping","totalCalls","from_existing","attr","file_to_delete","removeAttr","push","init","JSON","stringify","e","tagDisplay","rownumber","creation","group_id","debug","student_id","student_email","student_name","create_student_file","callStudentFileServiceForGroup","grouping_id","student_group_id","student_grouping_id","folder_id","console","log","get_group_folder_id","call","methodname","args","folder_group_id","done","response","url","ref","fail","reason","error","owner_email","group_name","groupid","a_element","create_group_file","grouping_name","create_grouping_file","grouping_sharing","googledocid","callGroupingGroupFileService","urls","links","parse","t","link","get_grouping_url","i","control"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Provides the mod_googledocs/create_control module\n *\n * @package   mod_googledocs\n * @category  output\n * @copyright 2020 Veronica Bermegui\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module mod_googledocs/control\n */\ndefine(['jquery', 'core/log', 'core/ajax', 'mod_googledocs/delete_controls'], function ($, Log, Ajax, DeleteControl) {\n    'use strict';\n    /**\n     * Initializes the controls.\n     */\n    function init(create, dist_type) {\n        Log.debug('mod_googledocs/control: initializing delete controls of the mod_googledocs');\n        Log.debug(dist_type);\n       \n        var parentfile_id;\n        var files_to_erase = []; // Collection of files ids to delete after copies are created\n\n        if (dist_type == 'grouping_copy') {\n            parentfile_id = $('table.groupingTable').attr('data-parentfile-id');\n        }else{\n            parentfile_id = $('table.overviewTable').attr('data-googledoc-id');\n        }\n\n        var instance_id = $('table.overviewTable').attr('data-instance-id');\n        var countCalls = 0;\n        var group_folder_ids;\n\n        var control = new GoogledocsControl(parentfile_id, create,  \n        instance_id, files_to_erase, countCalls, dist_type, group_folder_ids);\n\n        control.main();\n    }\n\n    // Constructor.\n    function GoogledocsControl( parentfile_id, create,  instance_id, \n     files_to_erase, countCalls, dist_type, group_folder_ids) {\n        var self = this;\n        self.parentfile_id = parentfile_id;\n        self.create = create;\n        self.instance_id = instance_id;\n        self.files_to_erase = files_to_erase;\n        self.countCalls = countCalls;\n        self.dist_type = dist_type;\n        self.group_folder_ids = group_folder_ids;\n\n    }\n\n    GoogledocsControl.prototype.main = function () {\n        var self = this;\n        //var show_tags = true;\n        // Only call the create service if the files are not created.\n        // This JS is called in the view.php page, which calls the function\n        // that renders the table. It is the same table for created and processing\n        //when sharing by group or by bygrouping other WS is called\n\n        //if (!self.create) {\n            self.initTags();\n      //  }\n        switch(self.dist_type) {\n            case 'std_copy' :\n                if (!self.create) {\n                    self.callStudentFileService(self.parentfile_id);\n                }\n\n                break;\n\n            case 'group_copy' :\n                if (!self.create) {\n                    self.callGroupFileService();\n                }\n\n                break;\n\n            case 'grouping_copy' :\n                 if (!self.create) {\n                    self.callGroupingFileService();\n                }\n\n                break;\n\n            case 'std_copy_group_copy':\n                 if(!self.create) {\n                   self.create_group_folder();\n                 }\n\n                break;\n\n          //  default :  show_tags = false;;\n        }\n\n       /* if(show_tags) {\n           self.initTags();\n        }*/\n  \n        // When sharing by group or grouping. The same file is shared.\n        // The generation of this file might be quick, but giving the students\n        // a permission can take some time. In order for the entire sharing is done\n        // The progress bar is only removed when all the ajax calls finish.\n        $(document).ajaxStop(function() {\n\n           $('tbody').children().each(function(e){\n            var tag = $(this).find('#status_col');\n            tag.removeClass('spinner-border color');\n            tag.html('Created');\n            tag.addClass('tag_doc success');\n           });\n\n           if(self.dist_type == 'grouping_copy' ){ //self.grouping_sharing\n\n               $('tbody.grouping-groups td.groups').each(function(){\n\n                $(this).find('table').each(function(){\n                    var tag = $(this).find(\"#file_grouping\");\n                    tag.removeClass('spinner-border color');\n                    tag.html('Created');\n                    tag.addClass('tag_doc success');\n                });\n             });\n\n                if(self.files_to_erase.length > 0) {\n                    self.delete_file_from_grouping();\n                    self.files_to_erase = [];\n                }\n           }\n\n           // Once the students get their file or permission to access file\n           // delete the original file (when the file is created with the activity module)\n           // don't delete originals created with the \"Create from existing\" option.\n           //For group and students distribution is the same process.\n            var totalCalls = $('tbody').children().length;\n            var from_existing = $('table.overviewTable').attr('data-from-existing');\n            var file_to_delete = $('table.overviewTable').attr('data-googledoc-id');\n            $('table.overviewTable').removeAttr('data-googledoc-id');\n\n            if (self.countCalls == totalCalls && file_to_delete != undefined \n                    && from_existing == 0 && self.dist_type != 'grouping_copy'){\n                self.files_to_erase.push(file_to_delete);\n                DeleteControl.init(JSON.stringify(self.files_to_erase), self.dist_type);\n                self.countCalls = 0;\n            }\n\n        });\n\n    };\n\n    GoogledocsControl.prototype.initTags = function (){\n        var self = this;\n\n        $('tbody').children().each(function(e){\n            if ($('#link_file_' + e).attr('href') != '#'){\n                self.tagDisplay(e, self.create);\n            }else{\n                self.tagDisplay(e, self.create);\n            }\n        });\n\n    };\n\n\n    /**\n     *\n     * @param {int} rownumber\n     * @param  boolean creation\n     * @returns display created or failed on the table's status column.\n     */\n    GoogledocsControl.prototype.tagDisplay = function(rownumber, creation){\n        if(creation === true) {\n            $('#file_' + rownumber).html('Created');\n            $('#file_' + rownumber).addClass('tag_doc success');\n\n        }else{\n           // $('#file_' + rownumber).html('Failed');\n            $('#file_' + rownumber).addClass('spinner-border color');\n        }\n\n    };\n\n    /**\n     * Example with file name Grouping_Share and groupings called Even and Odd respectively\n     * Even grouping has groups 2 and 4, Odd has groups 1 and 3\n     * Files created:\n     * 1. Grouping_Share \n     * 2. Grouping_share_odd\n     *     Grouping_Share_Grouping_share_odd_group_1\n     *       Grouping_Share_Grouping_share_odd_group_3\n     * 3. Grouping_share_even\n     *     Grouping_Share_Grouping_share_even_group_2\n     *       Grouping_Share_Grouping_share_even_group_4\n     *\n     * This function process the deletion of the following files:\n     *    Grouping_Share\n     *    Grouping_share_odd\n     *    Grouping_share_even\n     * @returns {undefined}\n     */\n    GoogledocsControl.prototype.delete_file_from_grouping = function () {\n        var self = this;\n        DeleteControl.init(JSON.stringify(self.files_to_erase), self.dist_type);\n        self.files_to_erase = [];\n        self.countCalls = 0;\n     \n    };\n\n\n    GoogledocsControl.prototype.callStudentFileService = function(parentfile_id, group_id = 0 ){\n        var self = this;\n        \n        Log.debug(\"callStudentFileService\");\n        $('tbody').children().each(function(e){\n          \n            var student_id = $(this).attr('data-student-id');\n            var student_email = $(this).attr('data-student-email');\n            var student_name = $(this).attr('student-name');\n            var group_id = $(this).attr('student-group-id');\n            self.create_student_file(e, student_id, student_email, student_name, parentfile_id, group_id);\n\n        });\n\n    };\n\n    GoogledocsControl.prototype.callStudentFileServiceForGroup = function(parentfile_id, group_id, grouping_id = 0) {\n        var self = this;\n        Log.debug(\"Enters to: callStudentFileServiceForGroup\");\n        Log.debug(\"Parent file ID \" + parentfile_id + \"Group ID \" + group_id + \"Grouping ID \" + grouping_id);\n        $('tbody#group-members-'+group_id).children().each(function(e){\n\n            var student_id = $(this).attr('data-student-id');\n            var student_email = $(this).attr('data-student-email');\n            var student_name = $(this).attr('student-name');\n            var student_group_id = $(this).attr('student-group-id');\n            if(student_group_id == group_id) {\n                self.create_student_file(e, student_id, student_email, student_name, parentfile_id,\n                                          student_group_id,  grouping_id );\n\n            }\n        });\n\n    };\n\n\n    GoogledocsControl.prototype.create_student_file = function (rownumber, student_id, student_email,student_name, parentfile_id, \n                                                                student_group_id = 0,\n                                                                student_grouping_id = 0 ) {\n        var self = this;\n        var folder_id = 0;\n        if(self.dist_type != 'group_copy') {\n            console.log(\"HEY!\");\n           $('#file_' + rownumber).addClass('spinner-border color'); // progress bar visible. spinner-border\n        }\n\n        if(self.dist_type == 'std_copy_group_copy') {\n            folder_id = self.get_group_folder_id(student_group_id, self.group_folder_ids);\n        }\n\n\n        Ajax.call([{\n\n                methodname: 'mod_googledocs_create_students_file',\n\n                args: {\n                    folder_group_id: folder_id,\n                    group_id : student_group_id,\n                    grouping_id: student_grouping_id,\n                    instance_id : self.instance_id,\n                    parentfile_id: parentfile_id,\n                    student_email: student_email,\n                    student_id: student_id,\n                    student_name: student_name\n                },\n\n                done: function (response) {\n                    Log.debug(response.url);\n                    self.countCalls++;\n                    // Add file's link\n                    var ref = $('#' + 'link_file_' + rownumber);\n                    $(ref).attr(\"href\", response.url);\n                    // Remove progress bar and display status\n                    if(self.dist_type != 'group_copy') {\n                        $('#file_' + rownumber).removeClass('spinner-border color');\n                        self.tagDisplay(rownumber, true);\n                    }\n                },\n\n                fail: function (reason) {\n                    Log.error(reason);\n                    $('#file_' + rownumber).removeClass('spinner-border color');\n                    self.tagDisplay(rownumber, false);\n                }\n            }]);\n\n\n    };\n\n    GoogledocsControl.prototype.callGroupFileService = function (){\n\n        var owner_email = $('table.overviewTable').attr('data-owner-email');\n        var self = this;\n\n        $('tbody').find('[data-group-name]').each(function(){\n            self.countCalls++;\n            var group_name = $(this).attr('data-group-name');\n            var groupid =   $(this).attr('data-group-id');\n            var a_element = ($(this).find('#shared_link_url_' + groupid))[0]; //It is always the one element.\n           ($(this).find('div#status_col')).addClass('spinner-border color');\n            self.create_group_file(a_element, owner_email, group_name, groupid);\n\n        });\n\n    };\n\n    GoogledocsControl.prototype.callGroupingFileService = function (){\n\n        $('tbody.grouping-groups td.groups').each(function(){\n           $(this).find('table').each(function(){\n                ($(this).find(\"#file_grouping\")).addClass('spinner-border color');\n           });\n        });\n\n        var owner_email = $('table.groupingTable').attr('data-owner-email');\n\n        var self = this;\n\n        $('tbody').find('[data-grouping-name]').each(function(){\n            var grouping_name = $(this).attr('data-grouping-name');\n            var grouping_id =   $(this).attr('data-grouping-id');\n            self.create_grouping_file (grouping_name, grouping_id, owner_email);\n        });\n    };\n    \n    \n    /**\n     * Creates the file FileName_Group_Name\n     * @param htmlElement a_element\n     * @param String owner_email\n     * @param String group_name\n     * @param int group_id\n     * @param int parentfile_id\n     * @param int grouping_id\n     *\n     */\n    GoogledocsControl.prototype.create_group_file = function(a_element ,owner_email, group_name, group_id, parentfile_id = 0,\n    grouping_id = 0){\n\n        var self = this;\n\n        if(!self.grouping_sharing) {\n            parentfile_id = self.parentfile_id;\n        }\n\n        Ajax.call([{\n            methodname: 'mod_googledocs_create_group_file',\n            args: {\n                group_name: group_name,\n                group_id: group_id,\n                grouping_id: grouping_id,\n                instance_id: self.instance_id,\n                owner_email: owner_email,\n                parentfile_id: parentfile_id,\n            },\n            done: function (response) {\n                console.log(response);\n                 // Add file's link\n                $(a_element).attr(\"href\", response.url);\n                //Returns the ID of the file created for the group.\n                Log.debug('Group ID' + group_id)\n                self.callStudentFileServiceForGroup(response.googledocid, group_id);\n\n            },\n            fail: function (reason) {\n                Log.error(reason);\n            }\n        }]);\n\n\n    };\n    /**\n     * Creates the file FileName_GroupingName\n     * @param String grouping_name\n     * @param  int grouping_id\n     * @param String owner_email\n     *\n     */\n    GoogledocsControl.prototype.create_grouping_file = function (grouping_name, grouping_id, owner_email) {\n        var self = this;\n\n        Ajax.call([{\n            methodname: 'mod_googledocs_create_grouping_file',\n            args: {\n                grouping_name: grouping_name,\n                grouping_id: grouping_id,\n                owner_email: owner_email,\n                parentfile_id: self.parentfile_id,\n            },\n            done: function (response) {\n                console.log(response);\n                // Add file's link\n                //Returns the ID of the file created for the groups and the URL. \n                self.callGroupingGroupFileService(grouping_id, response.urls);\n                self.files_to_erase.push(response.googledocid);\n            },\n            fail: function (reason) {\n                Log.error(reason);\n            }\n        }]);\n    };\n\n   /**\n    * Creates the file FileName_GroupingName_GroupName\n    * @param int parentfile_id\n    * @param int grouping_id\n    * @param url url\n    *\n    */\n    GoogledocsControl.prototype.callGroupingGroupFileService = function(grouping_id, urls){\n        var  self = this;\n        var  links = JSON.parse(urls);\n    //    console.log(\"callGroupingGroupFileService\" +  urls);\n      //  Log.debug(self.get_grouping_url(grouping_id, urls));\n        \n       $('tbody.grouping-groups td.groups').each(function(e){\n          \n            $(this).find('table').each(function(){\n                var t = $(this);\n                var group_id = t.attr('data-group-id');\n                var link = (t.find('#shared_link_' + grouping_id))[0];\n                var url = self.get_grouping_url(group_id, links);\n                console.log(links);\n                \n                $(link).attr(\"href\",url);\n\n            });\n\n        });\n    };\n    \n    //Dist. Each student from a group gets a copy. Create group folders\n    GoogledocsControl.prototype.create_group_folder = function(){\n        var self = this;\n\n        Ajax.call([{\n            methodname: 'mod_create_group_folder_struct',\n            args: {\n                instance_id: self.instance_id\n            },\n            done: function (response) {\n               Log.debug('mod_create_group_folder_struct  ' + JSON.parse(response.group_folder_ids));\n               self.group_folder_ids = JSON.parse(response.group_folder_ids);\n               self.callStudentFileService(self.parentfile_id,0, self.group_folder_ids);\n\n            },\n            fail: function (reason) {\n                Log.error(reason);\n            }\n        }]);\n    };\n\n    GoogledocsControl.prototype.get_group_folder_id = function (group_id, group_folder_ids) {\n        Log.debug(\"get_group_folder_id\" +  group_id + \" \" + group_folder_ids);\n        for(var i = 0; i < group_folder_ids.length; i++) {\n            if (group_folder_ids[i].group_id == group_id) {\n               return group_folder_ids[i].folder_id;\n               break;\n            }\n        }\n\n    };\n\n     GoogledocsControl.prototype.get_grouping_url = function (group_id, urls) {\n         Log.debug(\"get_grouping_url\");\n         Log.debug(group_id);\n         for(var i= 0; i< urls.length; i++) {\n             if(urls[i].group_id == group_id){\n                 return urls[i].url;\n                 break; \n             }\n\n         }\n     }\n\n\n    return {\n        init: init\n    };\n });"],"file":"create_controls.min.js"}