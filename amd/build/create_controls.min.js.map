{"version":3,"sources":["../src/create_controls.js"],"names":["define","$","Log","Ajax","DeleteControl","UpdateControl","GoogledocsControl","parentfile_id","create","instance_id","files_to_erase","countCalls","dist_type","group_folder_ids","self","prototype","main","window","addEventListener","popstateHandler","beforeunloadHandler","removeEventListener","initTags","callStudentFileService","callGroupFileService","initGroupingTags","callGroupingFileService","create_group_folder","shareSameGroupGroupingService","callGroupGroupingFileService","initGGTags","document","ajaxStop","children","each","tag","find","removeClass","html","addClass","from_existing","attr","length","delete_file_from_grouping","totalCalls","file_to_update","removeAttr","push","init","JSON","stringify","event","preventDefault","returnValue","debug","e","tagDisplay","gid","statuscol","rownumber","creation","failedTag","group_id","student_id","student_email","student_name","dist","create_student_file","callStudentFileServiceForGroup","grouping_id","student_group_id","student_grouping_id","folder_id","get_group_folder_id","call","methodname","args","folder_group_id","done","response","url","urls","parse","renderStudentLinks","ref","fail","reason","error","forEach","index","src","append","owner_email","group_name","groupid","a_element","create_group_file","create_grouping_file","owneremail","instanceid","gname","gtype","aelement","create_group_grouping_file","grouping_sharing","append_links_to_icons","googledocid","parentfileid","id","get_grouping_url","groupingsurl","get_grouping_url_for_student","g_ids","groups","split","i","includes","ids","links","append_links_helper","console","log","control"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Provides the mod_googledocs/create_control module\n *\n * @package   mod_googledocs\n * @category  output\n * @copyright 2020 Veronica Bermegui\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module mod_googledocs/controls\n */\ndefine(['jquery', 'core/log', 'core/ajax', 'mod_googledocs/delete_controls', 'mod_googledocs/update_controls'],\nfunction ($, Log, Ajax, DeleteControl, UpdateControl) {\n    'use strict';\n    /**\n     * Initializes the controls.\n     */\n    function init(create, dist_type) {\n        Log.debug('mod_googledocs/update_control: initializing of the mod_googledocs control');\n        Log.debug(dist_type);\n\n        var parentfile_id = $('table.overviewTable').attr('data-googledocs-id');\n        var files_to_erase = []; // Collection of files ids to delete after copies are created\n        var instance_id = $('table.overviewTable').attr('data-instance-id');\n        var countCalls = 0;\n        var group_folder_ids;\n\n        var control = new GoogledocsControl(parentfile_id, create, instance_id, \n        files_to_erase, countCalls, dist_type, group_folder_ids);\n\n        control.main();\n    }\n\n    // Constructor.\n    function GoogledocsControl( parentfile_id, create,  instance_id, \n     files_to_erase, countCalls, dist_type, group_folder_ids) {\n\n        var self = this;\n        self.parentfile_id = parentfile_id;\n        self.create = create;\n        self.instance_id = instance_id;\n        self.files_to_erase = files_to_erase;\n        self.countCalls = countCalls;\n        self.dist_type = dist_type;\n        self.group_folder_ids = group_folder_ids;\n\n    }\n\n    GoogledocsControl.prototype.main = function () {\n        var self = this;\n        window.addEventListener('popstate', self.popstateHandler);\n        // Only call the create service if the files are not created.\n        // This JS is called in the view.php page, which calls the function\n        // that renders the table. It is the same table for created and processing\n        //when sharing by group or by bygrouping other WS is called\n        if (!self.create) {\n            window.addEventListener('beforeunload', self.beforeunloadHandler);\n        } else {\n            window.removeEventListener('beforeunload', self.beforeunloadHandler, false);\n        }\n\n        self.initTags();\n\n        switch(self.dist_type) {\n\n            case 'std_copy' :\n                if (!self.create) {\n                    self.callStudentFileService(self.parentfile_id);\n                }\n                break;\n\n            case 'group_copy' :\n                if (!self.create) {\n                    self.callGroupFileService();\n                }\n                break;\n\n            case 'grouping_copy' :\n                self.initGroupingTags();\n                if (!self.create) {\n                    self.callGroupingFileService();\n                }\n                break;\n\n            case 'std_copy_group':\n                if(!self.create) {\n                   self.create_group_folder();\n                }\n                break;\n\n            case 'dist_share_same' :\n                if(!self.create) {\n                   self.callStudentFileService(self.parentfile_id);\n                }\n                break;\n\n            case 'dist_share_same_group' :\n                if (!self.create) {\n                  // self.create_group_folder();\n                   self.shareSameGroupGroupingService();\n                }\n                break;\n            case 'dist_share_same_grouping' :\n                if (!self.create) {\n                   self.callGroupingFileService(self.parentfile_id);\n                }\n                break;\n            case 'std_copy_grouping' :\n                if(!self.create) {\n                    self.create_group_folder();\n                }\n                break;\n            case 'std_copy_group_grouping':\n                if(!self.create) {\n                    self.create_group_folder();\n                }\n                break;\n            case 'group_grouping_copy' :\n                if (!self.create) {\n                    self.callGroupGroupingFileService();\n                }else{\n                    self.initGGTags();\n                }\n                break;\n            case 'dist_share_same_group_grouping' :\n                if (!self.create) {\n                   self.callGroupGroupingFileService();\n                } else {\n                    self.initGGTags();\n                }\n                break;\n\n        }\n        //\n\n        // When sharing by group or grouping. The same file is shared.\n        // The generation of this file might be quick, but giving the students\n        // a permission can take some time. In order for the entire sharing is done\n        // The progress bar is only removed when all the ajax calls finish.\n        $(document).ajaxStop(function() {\n\n            $('tbody').children().each(function(){\n                var tag = $(this).find('#status_col');\n                tag.removeClass('spinner-border color');\n                tag.html('Created');\n                tag.addClass('tag_doc success');\n            });\n\n            var from_existing = $('table.overviewTable').attr('data-from-existing');\n\n            if(self.dist_type == 'grouping_copy'){\n\n               $('tbody.grouping-groups td.groups').each(function(){\n\n                    $(this).find('table').each(function(){\n                        var tag = $(this).find(\"#file_grouping\");\n                        tag.removeClass('spinner-border color');\n                        tag.html('Created');\n                        tag.addClass('tag_doc success');\n                    });\n                });\n\n                if(self.files_to_erase.length > 0  && from_existing == 0) {\n                    self.delete_file_from_grouping();\n                    self.files_to_erase = [];\n                }\n           }\n\n           // Once the students get their file or permission to access file\n           // delete the original file (when the file is created with the activity module)\n           // don't delete originals created with the \"Create from existing\" option.\n           //For group and students distribution is the same process.\n            var totalCalls = $('tbody').children().length;\n            var file_to_update = $('table.overviewTable').attr('data-googledocs-id');\n\n            $('table.overviewTable').removeAttr('data-googledocs-id');\n\n            if(from_existing == 1 && self.countCalls == totalCalls\n                    && file_to_update != undefined ) {\n               self.files_to_erase.push(file_to_update);\n               UpdateControl.init(JSON.stringify(self.files_to_erase));\n               self.countCalls = 0;\n            }\n\n            if(self.dist_type == 'group_grouping_copy' && self.countCalls == totalCalls) {\n               self.files_to_erase.push(file_to_update);\n               DeleteControl.init(JSON.stringify(self.files_to_erase), self.dist_type);\n               self.countCalls = 0;\n            }\n\n            if (self.countCalls == totalCalls && file_to_update != undefined \n                    && from_existing == 0 && self.dist_type != 'grouping_copy'){\n                self.files_to_erase.push(file_to_update);\n                DeleteControl.init(JSON.stringify(self.files_to_erase), self.dist_type);\n                self.countCalls = 0;\n            }\n\n        });\n    };\n\n    // Triggers when user tries to leave the page and documents are being created.\n    GoogledocsControl.prototype.beforeunloadHandler = function (event, created) {\n        event.preventDefault();\n        event.returnValue = '';\n    }\n    GoogledocsControl.prototype.popstateHandler = function (event) {\n        Log.debug('popstateHandler');\n    }\n\n    GoogledocsControl.prototype.initTags = function (){\n        var self = this;\n        $('tbody').children().each(function(e){\n            if ($('#link_file_' + e).attr('href') != '#'){\n                self.tagDisplay(e, self.create);\n            }else{\n                self.tagDisplay(e, self.create);\n            }\n        });\n    };\n\n    GoogledocsControl.prototype.initGGTags = function () {\n\n         $('tbody').find('[data-g-name]').each(function(){\n            var gid = $(this).attr('data-g-id');\n            var statuscol = ($(this).find('div#status_col_' + gid));\n            $(statuscol).html('Created');\n            $(statuscol).addClass('tag_doc success');\n        });\n    };\n\n    GoogledocsControl.prototype.initGroupingTags = function () {\n        var self = this;\n       \n         $('tbody').find('[data-grouping-name]').each(function(){\n            var gid = $(this).attr('data-grouping-id');\n            var statuscol = ($(this).find('div#status_col_' + gid));\n            if (self.create) {\n                $(statuscol).html('Created');\n                $(statuscol).addClass('tag_doc success');\n            } else{\n                $('div#status_col_' + gid).addClass('spinner-border color');\n            }\n        });\n    };\n\n\n\n    /**\n     * display created or failed on the table's status column.\n     */\n    GoogledocsControl.prototype.tagDisplay = function(rownumber, creation){\n        if(creation === true) {\n            $('#file_' + rownumber).html('Created');\n            $('#file_' + rownumber).addClass('tag_doc success');\n\n        }else{\n           // $('#file_' + rownumber).html('Failed');\n            $('#file_' + rownumber).addClass('spinner-border color');\n        }\n\n    };\n\n    GoogledocsControl.prototype.failedTag = function (rownumber) {\n         $('#file_' + rownumber).html('Failed');\n    }\n\n\n    /**\n     * Example with file name Grouping_Share and groupings called Even and Odd respectively\n     * Even grouping has groups 2 and 4, Odd has groups 1 and 3\n     * Files created:\n     * 1. Grouping_Share \n     * 2. Grouping_share_odd\n     *     Grouping_Share_Grouping_share_odd_group_1\n     *       Grouping_Share_Grouping_share_odd_group_3\n     * 3. Grouping_share_even\n     *     Grouping_Share_Grouping_share_even_group_2\n     *       Grouping_Share_Grouping_share_even_group_4\n     *\n     * This function process the deletion of the following files:\n     *    Grouping_Share\n     *    Grouping_share_odd\n     *    Grouping_share_even\n     * @returns {undefined}\n     */\n    GoogledocsControl.prototype.delete_file_from_grouping = function () {\n        var self = this;\n        DeleteControl.init(JSON.stringify(self.files_to_erase), self.dist_type);\n        self.files_to_erase = [];\n        self.countCalls = 0;\n    };\n\n\n    GoogledocsControl.prototype.callStudentFileService = function(parentfile_id, group_id = 0 ){\n        var self = this;\n\n        Log.debug(\"callStudentFileService\");\n        $('tbody').children().each(function(e){\n\n            var student_id = $(this).attr('data-student-id');\n            var student_email = $(this).attr('data-student-email');\n            var student_name = $(this).attr('student-name');\n            var gid;\n\n            if (self.dist == 'dist_share_same_grouping' || self.dist == 'std_copy_grouping'){\n                gid = $(this).attr('student-grouping-id');\n            } else {\n                gid = $(this).attr('student-group-id');\n            }\n\n            self.create_student_file(e, student_id, student_email, student_name, parentfile_id, gid);\n        });\n\n    };\n\n    GoogledocsControl.prototype.callStudentFileServiceForGroup = function(parentfile_id, group_id, grouping_id = 0) {\n        var self = this;\n        Log.debug(\"Enters to: callStudentFileServiceForGroup\");\n        Log.debug(\"Parent file ID \" + parentfile_id + \"Group ID \" + group_id + \"Grouping ID \" + grouping_id);\n\n        $('tbody#group-members-'+group_id).children().each(function(e){\n\n            var student_id = $(this).attr('data-student-id');\n            var student_email = $(this).attr('data-student-email');\n            var student_name = $(this).attr('student-name');\n            var student_group_id = $(this).attr('student-group-id');\n            if(student_group_id == group_id) {\n                self.create_student_file(e, student_id, student_email, student_name, parentfile_id,\n                                          student_group_id,  grouping_id );\n\n            }\n        });\n\n    };\n\n\n    GoogledocsControl.prototype.create_student_file = function (rownumber, student_id, student_email,\n                                                                student_name, parentfile_id, \n                                                                student_group_id = 0,\n                                                                student_grouping_id = 0 ) {\n        var self = this;\n        var folder_id = 0;\n\n        if(self.dist_type != 'group_copy') {\n           $('#file_' + rownumber).addClass('spinner-border color'); // progress bar visible. spinner-border\n        }\n\n        if(self.dist_type == 'std_copy_group' \n            || self.dist_type == 'std_copy_grouping'\n            || self.dist_type == 'std_copy_group_grouping') {\n\n            folder_id = self.get_group_folder_id(student_group_id, self.group_folder_ids);\n            Log.debug(\"create_student_file student_name = \" + student_name );\n            Log.debug(\"create_student_file folder_id = \" + folder_id );\n        }\n\n        Ajax.call([{\n\n                methodname: 'mod_googledocs_create_students_file',\n\n                args: {\n                    folder_group_id: folder_id,\n                    group_id : student_group_id,\n                    grouping_id: student_grouping_id,\n                    instance_id : self.instance_id,\n                    parentfile_id: parentfile_id,\n                    student_email: student_email,\n                    student_id: student_id,\n                    student_name: student_name\n                },\n\n                done: function (response) {\n                    Log.debug(response.url);\n                    self.countCalls++;\n                    // Add file's link\n\n                    var urls = JSON.parse(response.url);\n\n                    if (self.dist_type == 'std_copy_group' \n                        ||self.dist_type == 'std_copy_grouping'\n                        || self.dist_type == 'std_copy_group_grouping') {\n\n                        self.renderStudentLinks(urls, rownumber);\n\n                    } else {\n                        var ref = $('#' + 'link_file_' + rownumber);\n                        $(ref).attr(\"href\", urls[0]);\n                    }\n\n                    // Remove progress bar and display status\n                    if(self.dist_type != 'group_copy') {\n                        $('#file_' + rownumber).removeClass('spinner-border color');\n                        self.tagDisplay(rownumber, true);\n                    }\n\n                },\n\n                fail: function (reason) {\n                    Log.error(reason);\n                    $('#file_' + rownumber).removeClass('spinner-border color');                   \n                    self.failedTag(rownumber);\n                }\n            }]);\n\n\n    };\n\n    // When dist. is each student from X group gets a copy. A student\n    // can get more than one copy.\n     GoogledocsControl.prototype.renderStudentLinks = function(urls, rownumber) {\n        urls.forEach(function(url, index){\n                       Log.debug('addLinks ' + rownumber);\n                        var ref = $('#' + 'link_file_' + rownumber);\n                        if(index === 0) {\n                           $(ref).attr(\"href\", url);\n                        }else{\n                           var src = $(ref).find(\"img\").attr(\"src\");\n                           $(ref).append('<a target=\"_blank\" id=\"link_file_' + rownumber +  '\"href=\"' + url + '\" class=\"link_icon\">\\n\\\n                            <img src=\"'+ src +'\" class=\"link_icon\"</a>');\n                        }\n                    }, rownumber);\n     };\n\n    GoogledocsControl.prototype.callGroupFileService = function (){\n\n        var owner_email = $('table.overviewTable').attr('data-owner-email');\n        var self = this;\n\n        $('tbody').find('[data-group-name]').each(function(){\n            self.countCalls++;\n            var group_name = $(this).attr('data-group-name');\n            var groupid =   $(this).attr('data-group-id');\n            var a_element = ($(this).find('#shared_link_url_' + groupid))[0]; //It is always the one element.\n           ($(this).find('div#status_col')).addClass('spinner-border color');\n            self.create_group_file(a_element, owner_email, group_name, groupid);\n\n        });\n\n    };\n\n\n    GoogledocsControl.prototype.callGroupingFileService = function (){\n        \n        var self = this;\n        var owner_email = $('table.overviewTable ').attr('data-owner-email');\n        self.create_grouping_file(owner_email);        \n    };\n\n    GoogledocsControl.prototype.callGroupGroupingFileService = function (){\n        var owneremail = $('table.overviewTable').attr('data-owner-email');\n        var instanceid = $('table.overviewTable').attr('data-instance-id');\n        var self = this;\n\n        $('tbody').find('[data-g-name]').each(function(){\n            self.countCalls++;\n            var gname = $(this).attr('data-g-name');\n            var gid = $(this).attr('data-g-id');\n            var gtype = $(this).attr('data-g-type');            \n            var aelement = ($(this).find('#shared_link_url_' + gid))[0]; //It is always the one element.\n            var statuscol = ($(this).find('#status_col_' + gid));\n           ($(this).find('div#status_col_' + gid)).addClass('spinner-border color');\n            self.create_group_grouping_file(aelement, statuscol, owneremail, instanceid, gname, gid, gtype);\n\n        });\n    };\n\n    /**\n     * Creates the file FileName_Group_Name\n     * @param htmlElement a_element\n     * @param String owner_email\n     * @param String group_name\n     * @param int group_id\n     * @param int parentfile_id\n     * @param int grouping_id\n     *\n     */\n    GoogledocsControl.prototype.create_group_file = function(a_element = '' , \n    owner_email, group_name = '', group_id, parentfile_id = 0, grouping_id = 0){\n\n        var self = this;\n\n        if(!self.grouping_sharing) {\n            parentfile_id = self.parentfile_id;\n        }\n\n        Ajax.call([{\n            methodname: 'mod_googledocs_create_group_file',\n            args: {\n                group_name: group_name,\n                group_id: group_id,\n                grouping_id: grouping_id,\n                instance_id: self.instance_id,\n                owner_email: owner_email,\n                parentfile_id: parentfile_id,\n            },\n            done: function (response) { \n                Log.debug(\"mod_googledocs_create_group_file \" + response);\n                if(self.dist_type == 'dist_share_same_group' \n                        || self.dist_type == 'dist_share_same_grouping_copy'\n                        || self.dist_type == 'dist_share_same_group_grouping_copy') {\n                    self.append_links_to_icons(response.url); //  Traverse the list of students and add the link accoding to the group they belong to.\n                }else{\n                    // Add file's link\n                   $(a_element).attr(\"href\", response.url);\n                   //Returns the ID of the file created for the group.\n                   Log.debug('Group ID' + group_id)\n                   self.callStudentFileServiceForGroup(response.googledocid, group_id);\n                }\n\n                self.files_to_erase.push(parentfile_id);\n\n            },\n            fail: function (reason) {\n                Log.error(reason);\n            }\n        }]);\n\n\n    };\n\n    /**\n     * Creates the file FileName_GroupingName for all the groupings selected.\n     * The same url is shared with the members of the grouping groups.\n     * @param String grouping_name\n     * @param  int grouping_id\n     * @param String owner_email\n     */\n    GoogledocsControl.prototype.create_grouping_file = function (owner_email) {\n        var self = this;\n        Log.debug(\"create_grouping_file llamada\");\n\n        Ajax.call([{\n            methodname: 'mod_googledocs_create_grouping_file',\n            args: {\n                owneremail: owner_email,\n                parentfileid: self.parentfile_id,\n            },\n            done: function (response) {\n\n                if (self.dist_type == 'grouping_copy') {\n                   Log.debug(response) ;\n                    $('tbody tr').each(function(){\n                        var id = $(this).attr('data-grouping-id');  // Get the grouping id\n                        self.get_grouping_url(id, JSON.parse(response.groupingsurl)); \n                    });\n                } else {\n                    // Add file's link\n                    $('tbody tr').each(function(e){\n                        var id = $(this).attr('student-grouping-id');  // Get the grouping id(s) the student belongs to\n                        self.get_grouping_url_for_student(id, JSON.parse(response.groupingsurl), e); \n                    });\n                }\n            },\n            fail: function (reason) {\n                Log.error(reason);\n            }\n        }]);\n    };\n\n    GoogledocsControl.prototype.create_group_grouping_file = function (aelement = '', statuscol = '',owneremail,\n                                                                             instanceid, gname, gid, gtype ) {\n        var self = this;\n        Ajax.call([{\n            methodname: 'mod_googledocs_create_group_grouping_file',\n            args: {\n                gid: gid,\n                gname: gname,\n                gtype: gtype,\n                instanceid: instanceid,\n                owneremail: owneremail,\n                parentfileid: self.parentfile_id,\n                },\n                done: function (response) {\n                    // Add file's link.\n                    $(aelement).attr(\"href\", response.url);\n                    // Change status.\n                    $(statuscol).removeClass('spinner-border color');\n                    $(statuscol).html('Created');\n                    $(statuscol).addClass('tag_doc success');\n\n                },\n                fail: function (reason) {\n                    Log.error(reason);\n                }\n            }]);\n    };\n   /* TODO: DELETE WHEN GOING TO PROD.\n    GoogledocsControl.prototype.test_service = function () {\n        Log.debug(\" Starting test_service\");\n        Ajax.call([{\n            methodname: 'mod_googledocs_test_service_call',\n            args: {\n                file_ids: '123',\n                },\n                done: function (response) {\n                    \n                  Log.debug(response.results);\n\n                },\n                fail: function (reason) {\n                    Log.debug(reason);\n                }\n            }]);\n    };\n  */\n\n    //Dist. Each student from a group gets a copy or each std. from a group share same copy. Create group folders\n    GoogledocsControl.prototype.create_group_folder = function(){\n        var self = this;\n        Log.debug(\"create_group_folder \" + self.instance_id);\n        Ajax.call([{\n            methodname: 'mod_googledocs_create_group_folder_struct',\n            args: {\n                instanceid: self.instance_id,\n            },\n            done: function (response) {\n               Log.debug('mod_googledocs_create_group_folder_struct');\n               self.group_folder_ids = JSON.parse(response.group_folder_ids);\n               // Each student will get a copy.\n               if(self.dist_type ==  'std_copy_group' \n                    || self.dist_type == 'std_copy_grouping'\n                    || self.dist_type == 'std_copy_group_grouping') {\n\n                    self.callStudentFileService(self.parentfile_id);\n               }\n\n               // Create the copy and the owner is the teacher.\n               if(self.dist_type == 'dist_share_same_group'\n                    || self.dist_type == 'dist_share_same_grouping_copy'\n                    || self.dist_type == 'dist_share_same_group_grouping_copy') {\n\n                   var g_ids = $('table.overviewTable').attr('data-all-groups');\n                   var owner_email = $('table.overviewTable').attr('data-owner-email');\n                   self.create_group_file('',owner_email, '', g_ids, self.parentfile_id);\n               }\n\n            },\n            fail: function (reason) {\n                Log.error(reason);\n            }\n        }]);\n    };\n\n    GoogledocsControl.prototype.shareSameGroupGroupingService = function () {\n        var self = this;\n        var g_ids = $('table.overviewTable').attr('data-all-groups');\n        var owner_email = $('table.overviewTable').attr('data-owner-email');\n        self.create_group_file('',owner_email, '', g_ids, self.parentfile_id);\n        \n    };\n\n    /**\n     * \n     * @param {type} group_id\n     * @param {type} group_folder_ids\n     * @returns {unresolved}\n     */\n    GoogledocsControl.prototype.get_group_folder_id = function (group_id, group_folder_ids) {  \n        var groups = group_id.split('-');\n        for(var i = 0; i < group_folder_ids.length; i++) {\n            if (group_folder_ids[i].group_id == group_id || groups.includes(group_folder_ids[i].group_id)) {\n               return group_folder_ids[i].folder_id;\n               break;\n            }\n        }\n\n    };\n\n    /**\n     * Get the URL(s) generated for the grouping with the given id\n     * If a student belongs to more than one grouping, return all the urls\n     * This function is called when the distribution is dist_share_same_grouping      \n     */\n    GoogledocsControl.prototype.get_grouping_url_for_student = function (id, urls, rownumber) {\n\n        var ids =  id.split('-');\n        var links = [];\n        var self = this;\n\n        for (var i = 0 ; i < urls.length; i++) {\n          \n            if (ids.includes(urls[i].gid)) {\n                links.push(urls[i].url);\n            }\n        }\n        Log.debug(links);\n        self.append_links_helper(links, rownumber);\n    };\n  \n    /**\n     * Get the URL generated for the grouping with the given id\n     * This function is called when the distribution is grouping_copy\n     */\n    GoogledocsControl.prototype.get_grouping_url = function (id, urls) {\n\n        var ref = $('#' + 'shared_link_url_' + id);  \n\n        for (var i = 0 ; i < urls.length; i++) {\n            if (id == (urls[i].gid)) {\n                $(ref).attr(\"href\", urls[i].url);\n                var tag = $('#status_col_' + id);\n                tag.removeClass('spinner-border color');\n                tag.html('Created');\n                tag.addClass('tag_doc success');\n                break;\n            }\n        }\n\n    };\n\n    /**\n     * For distributions involving GROUPS\n     * @param {type} urls\n     * @returns {undefined}\n     */\n    GoogledocsControl.prototype.append_links_to_icons = function(urls) {\n        var self = this;\n        \n        $('tbody').children().each(function(e){\n            self.countCalls++;\n            Log.debug('append_links_to_icons');\n            var id = $(this).attr('student-group-id');\n            //self.append_links_helper(links, rownumber);\n            self.get_grouping_url_for_student(id, JSON.parse(urls), e); \n     \n\n        });\n\n    };\n\n    //\n    /**\n     * Add the url in the href property. If the student has more than one\n     * grouping, append new icons\n     * Distribution = dist_share_same_grouping.\n     * @param {type} urls\n     * @param {type} rownumber\n     * @returns {undefined}\n     */\n    GoogledocsControl.prototype.append_links_helper = function(urls, rownumber) {\n        var self = this;\n        console.log('append_links_helper');\n        console.log(urls);\n        urls.forEach(function(url, index){\n           \n            console.log(\"LA URL ES: \" + url);\n            var ref = $('#' + 'link_file_' + rownumber);\n            var src = $(ref).find(\"img\").attr(\"src\");\n\n            if (index == 0) {\n                $(ref).attr(\"href\", url); // Set link the existing icon\n            } else {\n                $(ref).append('<a target=\"_blank\" id=\"link_file_' + rownumber +\n                '\"href=\"' + url + '\" class=\"link_icon\">\\n\\ \\n\\\n                <img src=\"'+ src +'\" class=\"link_icon\"</a>');\n            }\n\n            $('#file_' + rownumber).removeClass('spinner-border color');\n            self.tagDisplay(rownumber, true);\n        });\n    };\n\n    return {\n        init: init\n    };\n });"],"file":"create_controls.min.js"}